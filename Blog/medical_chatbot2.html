<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Cheng Kang (康成)</title><meta name="author" content="Cheng"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/">Cheng Kang (康成)</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/#About"> Profile</a></li><li class="menus_item"><a class="site-page" href="/Publications/#index"> Publications</a></li><li class="menus_item"><a class="site-page" href="/Projects/#index"> Projects</a></li><li class="menus_item"><a class="site-page" href="/Volunteer/#index"> Volunteer Experience</a></li><li class="menus_item"><a class="site-page" href="/Blog/#index"> Blog</a></li></ul></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/Kang.jpg'" alt="avatar"></div><div class="author-discrip"><h3>Cheng</h3><p class="author-bio">Cognitive Researcher.</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-icons"><li><a class="social-icon" href="https://twitter.com/kangcheng520" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://www.facebook.com/kang.cheng.108" target="_blank"><i class="fab fa-facebook-square" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://github.com/ChengKang520" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://www.linkedin.com/in/kang-cheng-9a7781180/" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/img/weixin.png" target="_blank"><i class="fab fa-weixin" aria-hidden="true"></i></a></li><li><a class="social-icon" href="mailto:kangchen@fel.cvut.cz" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i></a></li></ul><ul class="social-links"><li><a class="e-social-link" href="https://scholar.google.cz/citations?user=2gOnGH4AAAAJ&amp;hl=cs&amp;oi=sra" target="_blank"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span>Google Scholar</span></a></li><li><a class="e-social-link" href="https://orcid.org/0000-0001-9546-4585" target="_blank"><i class="fab fa-orcid" aria-hidden="true"></i><span>ORCID</span></a></li><li><a class="e-social-link" href="/attaches/Kang_CV.pdf" target="_blank"><i class="fas fa-cloud-download-alt" aria-hidden="true"></i><span>CV</span></a></li></ul></div><a class="cv-links" href="/attaches/F3-D-2025-Kang-Cheng-Kang-Cheng-Thesis-2025.pdf" target="_blank"><i class="fas fa-file-pdf" aria-hidden="true"><span>Doctoral Thesis</span></i></a></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><h2 class="page-title">Medical Conversation and Diagnosis Chatbot: Diagnosis (B)</h2><article><p><font face="Times" size="5"> This blog aims to show you how to get your own medical chatbot. There are two parts: </font><br><font face="Black" size="4"> A. Medical Conversation with Patients</font><br><font face="Arial Black" size="4"> B. Symptomes Extraction and Diseases Diagnozing </font></p>
<p><span style="font-family:Papyrus; font-size:2em;"> You can find the codes from this: </span><iframe
style="margin-left: 2px; margin-bottom:-5px;"
frameborder="0" scrolling="0" width="100px" height="20px"
src="https://ghbtns.com/github-btn.html?user=chengkang520&repo=Medical-Dialogue-Chatbot&type=star&count=true" ></p>
</iframe>

<hr>
<ol>
<li><a href="#data">Proper Medical Data</a></li>
<li><a href="#strategy">Chanllenge and Solution</a></li>
<li><a href="#train_medical_corpus">Train Your Medical Diagnosis NLP Model</a></li>
<li><a href="#test_medical_model">Test Your Model</a></li>
<li><a href="#deploy_chatbot">Deploy a Medical Chatbot</a></li>
</ol>
<h3 id="Proper-Medical-Data"><a href="#Proper-Medical-Data" class="headerlink" title=" Proper Medical Data  "></a><font face="黑体" size="5"> Proper Medical Data </font> <a name="crawler"></a></h3><p>This lower half targets on building task-oriented dialogue system for automatic medical diagnosis <a href="#refer-anchor-1"><sup>1,</sup></a><a href="#refer-anchor-2"><sup>2,</sup></a><a href="#refer-anchor-3"><sup>3</sup></a> , which converses with patients to collect additional symptoms beyond their self-reports and makes a disease diagnosis in the end. </p>
<p>MedDialog<a href="#refer-anchor-4"><sup>4</sup></a> provides 3.4 million annotation-free conversations between patients and doctors, which could be used for domain-adaptive pretraining. In this project, we can use medical chatbot to extract symptomes from dialogues between patients and doctors. We downloaded this medical dialogue data from <a target="_blank" rel="noopener" href="https://mlpcp21.github.io/pages/challenge.html"><font face="Times New Roman" size="4">ICLR 2021 Workshop: Machine Learning for Preventing and Combating Pandemics</font></a> which aims to generate context consistent and medically meaningful responses conditioned on the dialogue history. MedDG is a large-scale entity-centric medical dialogue dataset related to 12 types of common gastrointestinal diseases, with more than 17K conversations and 385K utterances collected from the online health consultation community. Each conversation is annotated with five different categories of entities, including diseases, symptoms, attributes, tests, and medicines. For more details about this dataset, please refer to <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2010.07497">this preprint</a>.</p>
<hr>
<h3 id="Chanllenge-and-Solution"><a href="#Chanllenge-and-Solution" class="headerlink" title=" Chanllenge and Solution  "></a><font face="黑体" size="5"> Chanllenge and Solution </font> <a name="strategy"></a></h3><p>We are now preparing our articel which discussed about two solutions to fix symptoms extraction problems. During chatting with the users, Chatbot, on the one hand, should generate the conversation, on the other hand, it also should extract positive and negative symtoms. <font face="black" size="4"> In our study, one available way is to use two models. Let one model judge the positive or negative, and let another one extract symptoms. </font>  </p>
<hr>
<h3 id="Train-Your-Medical-Diagnosis-NLP-Model"><a href="#Train-Your-Medical-Diagnosis-NLP-Model" class="headerlink" title=" Train Your Medical Diagnosis NLP Model  "></a><font face="黑体" size="5"> Train Your Medical Diagnosis NLP Model </font> <a name="train_medical_corpus"></a></h3><p>Below is the data strcture. The disadvantage of this medical dialogue data is that it did not provide the labels which contain patients symptoms, and <font face="Arial black" size="3">it only labeled whether there is a symptom word in the phrase. </font> </p>
<p><font face=" Arial black" size="3"> In our following research, we relabeled this medical data again to avoid chaos. </font> </p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;你好，肚脐周围隐隐作痛，不知道怎么回事（女，29岁）&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [<span class="string">&#x27;腹痛&#x27;</span>], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;你好，这种情况多长时间了？&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [<span class="string">&#x27;时长&#x27;</span>], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;两三天了。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;隐隐作痛，疼一会就不疼了。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;有没有用过什么药？做过什么检查吗。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;没有用药，也没有检查。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;大便正常吗。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;正常的。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;还有其他症状吗？恶心想吐吗。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [<span class="string">&#x27;恶心&#x27;</span>, <span class="string">&#x27;呕吐&#x27;</span>], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;没有。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;是隐隐约约的疼吗。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;食欲也好的，稍微有点腹胀。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [<span class="string">&#x27;腹胀&#x27;</span>], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;可能是胃肠功能紊乱。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [<span class="string">&#x27;胃肠功能紊乱&#x27;</span>], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;是的，隐隐约约的疼。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;吃点曲美步汀试试看。亲。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;感觉被针扎了一下，几秒钟就好了。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;感觉问题不是特别大。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;您吃我说的药物试试看。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;家里有个复方仙鹤草肠炎片能吃嘛吗。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: [<span class="string">&#x27;肠炎&#x27;</span>]&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;这个主要治腹泻的。没拉肚子不用吃。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [<span class="string">&#x27;腹泻&#x27;</span>, <span class="string">&#x27;腹泻&#x27;</span>], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;哦哦，好的。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;嗯嗯。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;哪方面会引起胃肠功能絮乱。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;可能是饮食方面可能是精神因素也可能是自身免疫系统。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;也可能是自身免疫系统消化系统。亲。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;好的。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;嗯嗯。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;好像有点像拉肚子，中午一吃完饭1，没过一会就想拉，稍微有点拉。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [<span class="string">&#x27;腹泻&#x27;</span>], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;那可以吃点您说的那个药物。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Patients&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;哦，好的。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;, </span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;Doctor&#x27;</span>, <span class="string">&#x27;Sentence&#x27;</span>: <span class="string">&#x27;嗯嗯。&#x27;</span>, <span class="string">&#x27;Symptom&#x27;</span>: [], <span class="string">&#x27;Medicine&#x27;</span>: [], <span class="string">&#x27;Test&#x27;</span>: [], <span class="string">&#x27;Attribute&#x27;</span>: [], <span class="string">&#x27;Disease&#x27;</span>: []&#125;]</span><br></pre></td></tr></table></figure>



<p>Before training, we extract the conversation between Doctors and Patients, as well as binary labels and multi-symtomes labels by <a target="_blank" rel="noopener" href="https://github.com/ChengKang520/Medical-Dialogue-Chatbot/blob/main/t5/data_preprocessing_track1.py">data_preprocessing_track1.py</a>. After this, we separate the dataset into train, train, validation. </p>
<p>Config of T5 in <a target="_blank" rel="noopener" href="https://github.com/ChengKang520/Medical-Dialogue-Chatbot/blob/main/t5/t5_symtoms_extract_binary.py">t5_symtoms_extract_binary.py</a>:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">args_dict = dict(</span><br><span class="line">        data_dir=<span class="string">&quot;&quot;</span>, <span class="comment"># path for data files</span></span><br><span class="line">        output_dir=<span class="string">&quot;&quot;</span>, <span class="comment"># path to save the checkpoints</span></span><br><span class="line">        model_name_or_path=t5_model,</span><br><span class="line">        tokenizer_name_or_path=t5_model,</span><br><span class="line">        max_seq_length=<span class="number">512</span>,</span><br><span class="line">        learning_rate=<span class="number">3e-4</span>,</span><br><span class="line">        weight_decay=<span class="number">0.0</span>,</span><br><span class="line">        adam_epsilon=<span class="number">1e-8</span>,</span><br><span class="line">        warmup_steps=<span class="number">0</span>,</span><br><span class="line">        train_batch_size=<span class="number">16</span>,</span><br><span class="line">        eval_batch_size=<span class="number">8</span>,</span><br><span class="line">        num_train_epochs=<span class="number">20</span>,</span><br><span class="line">        gradient_accumulation_steps=<span class="number">16</span>,</span><br><span class="line">        n_gpu=gpu_number,</span><br><span class="line">        <span class="comment"># early_stop_callback=False,</span></span><br><span class="line">        fp_16=<span class="title class_">False</span>, <span class="comment"># if you want to enable 16-bit training then install apex and set this to true</span></span><br><span class="line">        opt_level=<span class="string">&#x27;apex&#x27;</span>, <span class="comment"># you can find out more on optimisation levels here https://nvidia.github.io/apex/amp.html#opt-levels-and-properties</span></span><br><span class="line">        max_grad_norm=<span class="number">1.0</span>, <span class="comment"># if you enable 16-bit training then set this to a sensible value, 0.5 is a good default</span></span><br><span class="line">        seed=<span class="number">42</span>,</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>


<p>This is the batch file with the developing environment:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line"><span class="comment">#SBATCH --partition=gpufast</span></span><br><span class="line"><span class="comment">#SBATCH --time=4:00:00</span></span><br><span class="line"><span class="comment">#SBATCH --gres=gpu:1</span></span><br><span class="line"><span class="comment">#SBATCH --mem-per-gpu=32000</span></span><br><span class="line"><span class="comment">#SBATCH --job-name=T5-C</span></span><br><span class="line"><span class="comment">#SBATCH --err=T5-classifier.err </span></span><br><span class="line"><span class="comment">#SBATCH --out=T5-classifier.out </span></span><br><span class="line"><span class="comment">#SBATCH --mail-user=kangchen<span class="doctag">@cvut</span>.cz    # where send info about job</span></span><br><span class="line"><span class="comment">#SBATCH --mail-type=ALL              # what to send, valid type values are NONE, BEGIN, END, FAIL, REQUEUE, ALL</span></span><br><span class="line">/bin/hostname</span><br><span class="line">srun -l /bin/hostname</span><br><span class="line">srun -l /bin/pwd</span><br><span class="line">ml load <span class="title class_">Python</span>/<span class="number">3.7</span>.<span class="number">2</span>-fosscuda-2019a</span><br><span class="line">cd python_script/<span class="variable constant_">ICLR</span>-<span class="number">2021</span>/</span><br><span class="line">source <span class="title class_">TestEnv</span>/bin/activate</span><br><span class="line">python t5_symtoms_extract_multi.py</span><br></pre></td></tr></table></figure>


<hr>
<h3 id="Test-Your-Model"><a href="#Test-Your-Model" class="headerlink" title=" Test Your Model  "></a><font face="黑体" size="5"> Test Your Model </font> <a name="test_medical_model"></a></h3><p>Chatbot in you computer by excuting <a href="">chatbot_gui.py</a>.<br>There is an unsuccessful example which can present our onging research. We trained our incompletely labeled medical dialogue dataset with t5 (text-to-text transfer transformer) model, but the performance is not acceptabel. The next step is to relabel our dataset again and fine-tune t5 model.  </p>
<blockquote>
<p><font face="Black" color="black" size="3"> Doctor: </font>Do you have a stomach ache every time after eating, is your stomach bloated? Has the constipation started recently, or have you been constipated all the time?<br><font face="Black" color="black" size="3"> Patients: </font>It will be very bloated after eating…it will also be bloated and painful at other times! It also started this time… I was not constipated before.<font face="Times" color="red" size="3"> Detected Symptoms: </font> [‘asymptomatic’]<br><font face="Black" color="black" size="3"> Doctor: </font>Hi! How long have you been like this?<br><font face="Black" color="black" size="3"> Patients: </font>One week ~ I have been taking Shugan and Wei Wan for two days…it&#39;s a little better…but it still hurts…still constipated.<font face="Times" color="red" size="3"> Detected Symptoms: </font> [‘stomach ache’, ‘bloating’]</p>
</blockquote>
<hr>
<h3 id="Deploy-a-Medical-Chatbot"><a href="#Deploy-a-Medical-Chatbot" class="headerlink" title=" Deploy a Medical Chatbot  "></a><font face="黑体" size="5"> Deploy a Medical Chatbot </font> <a name="deploy_chatbot"></a></h3><p><span style="font-family:Papyrus; font-size:2em;">How to deploy your model in a HTML web is pending…<br></span></p>
<hr>
<p></font> <font face="Times" size="5"> Reference:</font> </p>
<div id="refer-anchor-1"></div>

<p>[1] <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2004.03329"> Guangtao Zeng, Wenmian Yang, Zeqian Ju, Yue Yang, Sicheng Wang, Ruisi Zhang, Meng Zhou, Jiaqi Zeng, Xiangyu Dong, Ruoyu Zhang, Hongchao Fang, Penghui Zhu, Shu Chen, Pengtao Xie. MedDialog: Large-scale Medical Dialogue Datasets. In EMNLP, 2020.</a></p>
<div id="refer-anchor-2"></div>

<p>[2] <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2004.14254">Zhongyu Wei, Qianlong Liu, Baolin Peng, Huaixiao Tou, Ting Chen, Xuanjing Huang, Kam-fai Wong, Xiangying Dai. Task-oriented Dialogue System for Automatic Diagnosis. In ACL, 2018.</a></p>
<div id="refer-anchor-3"></div>

<p>[3] <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1901.10623">Lin Xu, Qixian Zhou, Ke Gong, Xiaodan Liang, Jianheng Tang, Liang Lin. End-to-End Knowledge-Routed Relational Dialogue System for Automatic Diagnosis. In AAAI, 2019.</a></p>
<div id="refer-anchor-4"></div>

<p>[4] <a target="_blank" rel="noopener" href="https://ojs.aaai.org/index.php/AAAI/article/view/5456">Yuan Xia, Jingbo Zhou, Zhenhui Shi, Chao Lu, Haifeng Huang. Generative Adversarial Regularized Mutual Information Policy Gradient Framework for Automatic Diagnosis. In AAAI 2020.</a></p>
</article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/#About"> Profile</a></li><li class="nav_item"><a class="nav-page" href="/Publications/#index"> Publications</a></li><li class="nav_item"><a class="nav-page" href="/Projects/#index"> Projects</a></li><li class="nav_item"><a class="nav-page" href="/Volunteer/#index"> Volunteer Experience</a></li><li class="nav_item"><a class="nav-page" href="/Blog/#index"> Blog</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2019 - 2025 by Cheng</div><div class="theme-info">Powered by <a target="_blank" href="https://hexo.io" rel="nofollow noopener">Hexo</a> & <a target="_blank" href="https://github.com/PhosphorW/hexo-theme-academia" rel="nofollow noopener">Academia Theme</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/js/main.js"></script></body></html>